---
layout: post
title: íŠ¸ëœì­ì…˜ì´ë€?
categories: DB
tags: [DB]
---

## íŠ¸ëœì­ì…˜ì´ë€ ?
> ëª¨ë“  ëª…ë ¹ì–´ì˜ **ì„±ê³µ** ë˜ëŠ” **ì‹¤íŒ¨** ë¥¼ í•œêº¼ë²ˆì— ëª¨ì•„ì„œ ì²˜ë¦¬ í•˜ëŠ” ê²ƒ

ëª…ë ¹ì–´ ì¤‘ì— í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ í•œ íŠ¸ëœì­ì…˜ ë‚´ì˜ ëª¨ë“  ëª…ë ¹ì–´ë“¤ì´ ë¬´íš¨í™” (ë¡¤ë°±) ë¨

EX) ì€í–‰ì—ì„œ ëˆì„ ì†¡ê¸ˆí•˜ë ¤ê³  í•  ë•Œ

1. ë‚´ ê³„ì¢Œì—ì„œ ëˆì„ ì¶œê¸ˆ
2. ë‹¤ë¥¸ ê³„ì¢Œë¡œ ëˆì„ ì…ê¸ˆ

í•˜ëŠ” ê³¼ì •ì´ í•¨ê»˜ ì¼ì–´ ë‚˜ì•¼ í•˜ëŠ”ë° 2ë²ˆ ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•´ì„œ ì…ê¸ˆì´ ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ëˆì´ ë¶• ë– ë²„ë¦¬ëŠ” ì‚¬íƒœê°€ ì¼ì–´ë‚˜ê²Œ ë¨

=> ì´ ê²½ìš°ì—” 1, 2 ë¥¼ í•œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì–´ì„œ í•˜ë‚˜ì˜ ê³¼ì •ì´ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ë¡¤ë°± ë˜ë„ë¡ í•´ì•¼í•¨

### íŠ¸ëœì­ì…˜ì˜ ì„±ì§ˆ (ACID)

1. **Atomicity(ì›ìì„±)**
: íŠ¸ëœì­ì…˜ì€ ë¶€ë¶„ì ìœ¼ë¡œ ì™„ë£Œ ë  ìˆ˜ ì—†ìœ¼ë©°, ì „ì²´ê°€ ë‹¤ ë˜ê±°ë‚˜ ì•„ë¬´ê²ƒë„ ë˜ì§€ ì•Šê±°ë‚˜ ë‘˜ ì¤‘ í•˜ë‚˜ì—¬ì•¼ í•œë‹¤ 

â¡ ì¶œê¸ˆí•˜ëŠ” ê²ƒë§Œ ì„±ê³µí•˜ê³  ì…ê¸ˆ ë˜ëŠ” ê±´ ì„±ê³µí•˜ë©´ ì•ˆë¨ 

2. **Consistency(ì¼ê´€ì„±)**
: íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ì„ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•˜ë©´ ì–¸ì œë‚˜ **ì¼ê´€ì„± ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ**ë¡œ ìœ ì§€

â¡ ê³„ì¢Œ ì´ì²´ í•˜ê¸° ì „ ì§„í–‰ ì „ì˜ ëˆì˜ í•©ê³¼ ì§„í–‰ í›„ì˜ ëˆì˜ í•©ì´ ê°™ì•„ì•¼ í•¨ 

3. **Isolation(ë…ë¦½ì„±,ê²©ë¦¬ì„±)**
: íŠ¸ëœì­ì…˜ì„ ìˆ˜í–‰ ì‹œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ **ì—°ì‚° ì‘ì—…ì´ ë¼ì–´ë“¤ì§€ ëª»**í•˜ë„ë¡ ë³´ì¥

â¡ ì¶œê¸ˆ í›„ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ë¼ì–´ ë“¤ì–´ ë‚´ ê³„ì¢Œì— ë‚¨ì•„ ìˆëŠ” ê¸ˆì•¡ì„ ë³´ì§€ ëª»í•¨ 

4. **Durablility(ì˜ì†ì„±,ì§€ì†ì„±)**
: ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëœ íŠ¸ëœì­ì…˜ì€ **ì˜ì›íˆ ë°˜ì˜**

â¡ ì™„ë£Œ í›„ ì‹œìŠ¤í…œ ë¬¸ì œê°€ ìƒê¸°ë”ë¼ë„ ì»¤ë°‹ì´ ë˜ì—ˆë‹¤ë©´ DB ì— ì˜êµ¬ì ìœ¼ë¡œ ë°˜ì˜ 

=> í•˜ì§€ë§Œ ACID ì›ì¹™ì„ ì™„ë²½í•˜ê²Œ ì§€í‚¤ê²Œ ë˜ë©´ ë™ì‹œì„±ì´ ë§¤ìš° ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì— ì™„ë²½í•˜ê²Œ ì§€ì¼œì§€ì§€ ì•ŠëŠ” ê²½ìš°ë„ ìˆìŒ

ê·¸ë ‡ê¸° ë•Œë¬¸ì— ACID ì›ì¹™ì„ í¬ìƒí•˜ì—¬ ë™ì‹œì„±ì„ ì–»ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì¸ isolation Level (ê²©ë¦¬ ìˆ˜ì¤€) ì„ ì œê³µí•¨ 


### ğŸ’ Rails ì—ì„œ íŠ¸ëœì­ì…˜ ì‚¬ìš©í•˜ëŠ” ë²•

```RUBY
ActiveRecord::Base.transaction do 
  ## ì˜ˆì™¸ ë°œìƒ ì‹œ ë¡¤ë°± 
rescue => e
 	## ì˜ˆì™¸ ë°œìƒí•œ ê²½ìš° ì²˜ë¦¬ 
end
```

**transaction(isolation: :?)**

:read_uncommited / :read_commited / :repeatable_read / :serializable

ğŸŒŸ **save, save! ë©”ì„œë“œ ì°¨ì´** 

	save : ì €ì¥ ì„±ê³µ ì—¬ë¶€ë¥¼ true, false ë¡œë§Œ ë¦¬í„´
	
	save! : ì €ì¥ì´ ì‹¤íŒ¨í•  ê²½ìš° ì˜ˆì™¸ ë°œìƒ 
	
	í•˜ê¸° ë•Œë¬¸ì— íŠ¸ëœì­ì…˜ ì•ˆì—ì„œëŠ” save! ë¥¼ ì‚¬ìš©í•´ì•¼í•¨ 


### â˜•ï¸ ìŠ¤í”„ë§ì—ì„œ íŠ¸ëœì­ì…˜ ì‚¬ìš©í•˜ëŠ” ë²•
```java
@Transactional
```

ìŠ¤í”„ë§ì—ì„  í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ë©”ì†Œë“œ, í´ë˜ìŠ¤ ìœ„ì— ì‚¬ìš© 